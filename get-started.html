<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Get Started - Cleverly.ai</title>
    <link rel="stylesheet" href="index.css" />
    <link rel="stylesheet" href="auth.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
  </head>
  <body>
    <nav class="navbar">
      <div class="navbar-left">
        <a href="index.html">
          <img src="Cleverly AI.png" alt="logo" width="150" />
        </a>
      </div>
    </nav>

    <div class="auth-container">
      <div class="auth-card">
        <h2>Create Your Account</h2>
        <p class="auth-subtitle">Join Cleverly.ai and start learning smarter</p>

        <div class="account-type-selector">
          <label for="accountType">Choose your account type</label>
          <select id="accountType" class="custom-select" required>
            <option value="student" selected>Student</option>
            <option value="business" disabled>
              Business Account (Coming Soon)
            </option>
          </select>
          <p class="account-type-info">
            <strong>Student Account:</strong> Perfect for individual learners,
            students, and academics. Includes AI note generation, MCQ creation,
            and assignment help.
          </p>
        </div>

        <div class="social-auth">
          <button class="social-btn google">
            <img
              src="https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg"
              alt="Google"
            />
            Continue with Google
          </button>
          <button class="social-btn microsoft">
            <img
              src="https://upload.wikimedia.org/wikipedia/commons/9/96/Microsoft_logo_%282012%29.svg"
              alt="Microsoft"
            />
            Continue with Microsoft
          </button>
        </div>

        <div class="divider">
          <span>or sign up with email</span>
        </div>

        <form class="auth-form" id="register-form" novalidate>
          <div class="form-group">
            <label for="fullname">Full Name</label>
            <input
              type="text"
              id="fullname"
              name="fullname"
              required
              placeholder="Enter your full name"
            />
          </div>
          <div class="form-group">
            <label for="email">Email</label>
            <input
              type="email"
              id="email"
              name="email"
              required
              placeholder="name@example.com"
            />
          </div>
          <div class="form-group">
            <label for="password">Password</label>
            <div class="password-input">
              <input
                type="password"
                id="password"
                name="password"
                required
                placeholder="Create a password"
              />
              <button type="button" class="toggle-password" aria-label="Toggle password visibility">
                <i class="fa-regular fa-eye"></i>
              </button>
            </div>
            <div class="password-strength">
              <div class="strength-bar"></div>
              <span class="strength-text">Password strength: Weak</span>
            </div>
          </div>
          <div class="form-options">
            <label class="checkbox-label">
              <input type="checkbox" name="terms" required />
              <span
                >I agree to the <a href="#terms">Terms of Service</a> and
                <a href="#privacy">Privacy Policy</a></span
              >
            </label>
          </div>
          <button type="submit" class="auth-submit">
            Create Account
          </button>
          <p id="register-error" style="color: red; margin-top: 8px"></p>
          <p id="register-success" style="color: green; margin-top: 8px"></p>
        </form>

        <p class="auth-footer">
          Already have an account? <a href="signin.html">Sign In</a>
        </p>
      </div>
    </div>

    <script>
            const API_BASE_URL = "http://localhost:4000";

            const passwordInput = document.getElementById("password");
            const strengthBar = document.querySelector(".strength-bar");
            const strengthText = document.querySelector(".strength-text");

            passwordInput.addEventListener("input", () => {
              const password = passwordInput.value;
              let strength = 0;
              if (password.length >= 8) strength += 25;
              if (/[A-Z]/.test(password)) strength += 25;
              if (/[0-9]/.test(password)) strength += 25;
              if (/[^A-Za-z0-9]/.test(password)) strength += 25;
              strengthBar.style.width = strength + "%";

              if (strength <= 25) {
                strengthBar.style.backgroundColor = "#ff4444";
                strengthText.textContent = "Password strength: Weak";
              } else if (strength <= 50) {
                strengthBar.style.backgroundColor = "#ffbb33";
                strengthText.textContent = "Password strength: Fair";
              } else if (strength <= 75) {
                strengthBar.style.backgroundColor = "#00C851";
                strengthText.textContent = "Password strength: Good";
              } else {
                strengthBar.style.backgroundColor = "#007E33";
                strengthText.textContent = "Password strength: Strong";
              }
            });

            const toggleBtn = document.querySelector(".toggle-password");
            toggleBtn.addEventListener("click", () => {
              const input = toggleBtn.previousElementSibling;
              const icon = toggleBtn.querySelector("i");
              if (input.type === "password") {
                input.type = "text";
                icon.classList.replace("fa-eye", "fa-eye-slash");
              } else {
                input.type = "password";
                icon.classList.replace("fa-eye-slash", "fa-eye");
              }
            });

            document
              .getElementById("register-form")
              .addEventListener("submit", async (e) => {
                e.preventDefault();
                const errorElem = document.getElementById("register-error");
                const successElem = document.getElementById("register-success");
                errorElem.textContent = "";
                successElem.textContent = "";

                const fullname = document.getElementById("fullname").value.trim();
                const email = document.getElementById("email").value.trim();
                const password = document.getElementById("password").value;

                if (!fullname || !email || !password) {
                  errorElem.textContent = "Please fill in all required fields.";
                  return;
                }

                try {
                  const res = await fetch(`${API_BASE_URL}/auth/register`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ name: fullname, email, password }),
                  });

                  if (!res.ok) {
                    const errData = await res.json().catch(() => ({}));
                    errorElem.textContent = errData.error || "Registration failed.";
                    return;
                  }

            successElem.textContent =
              "Registration successful! Redirecting to login...";
      setTimeout(() => {
              window.location.href = "signin.html";
      }, 2000);
          } catch {
            errorElem.textContent = "Network error. Please try again later.";
          }
        });
    </script>

    <script src="script.js"></script>
  </body>
</html>
